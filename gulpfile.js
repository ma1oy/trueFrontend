"use strict";function configInit(t){conf=YAML.load(configFileDir),data=conf.prj,plg=conf.plg,dest=conf.dir.dest,src=conf.dir.src,watch=Object.assign({},src,conf.dir.watch),t()}function go(){return $.through2.obj(function(t,s,a){a(null,t)})}function no(t){t()}function reload(t){$.browserSync.reload(),t()}var configFileDir="config.yml",_ref=[{}],$=_ref[0],dest=_ref[1],src=_ref[2],watch=_ref[3],data=_ref[4],plg=_ref[5];Object.keys(require("./package.json").devDependencies).forEach(function(t){$[t.replace("gulp-","").replace(/-[a-z]/g,function(t,s,a){return a[++s].toUpperCase()})]=require(t)});var gulp=$.gulp,combine=$.streamCombiner2.obj,YAML=$.yamljs,conf=YAML.load(configFileDir);configInit(function(){}),gulp.task("build:html",function(t){combine(gulp.src(src.html),data.pre.html?$[data.pre.html]({data:data}):go(),data.mcbw.html[0]?$.htmlmin(plg.htmlmin):go(),gulp.dest(dest.html)).on("error",$.notify.onError({title:"build:html"})),t()}),gulp.task("build:css",function(t){combine(gulp.src(src.css),$.sourcemaps.init(),data.pre.css?$[data.pre.css](data.preOpt[data.pre.css]):go(),$.autoprefixer(plg.autoprefixer),data.mcbw.css[0]?$.cleanCss(plg.cleanCss):go(),$.sourcemaps.write(dest.srcMap),gulp.dest(dest.css)).on("error",$.notify.onError({title:"build:css"})),t()}),gulp.task("build:js",function(t){combine(gulp.src(src.js),$.sourcemaps.init(),data.pre.js?$[data.pre.js](data.preOpt[data.pre.js]):go(),data.mcbw.js[0]?$.uglify(plg.uglify):go(),$.sourcemaps.write(dest.srcMap),gulp.dest(dest.js)).on("error",$.notify.onError({title:"build:js"})),t()}),gulp.task("build:svg",function(t){combine(gulp.src(src.svg),data.mcbw.svg[0]?$.svgmin(plg.svgmin):go(),$.rename(function(t){var s=t.dirname.split(t.sep);"."==s[0]?s.shift():!0,s.push(t.basename),t.basename=s.join("-")}),$.svgstore(plg.svgstore),gulp.dest(dest.svg)).on("error",$.notify.onError({title:"build:svg"})),t()}),gulp.task("build:img",function(t){combine(gulp.src(src.img),data.mcbw.img[0]?$.imagemin(Object.assign(plg.imagemin,{use:[$.imageminPngquant()]})):go(),gulp.dest(dest.img)).on("error",$.notify.onError({title:"build:img"})),t()}),gulp.task("watch:cfg ",function(){return gulp.watch(configFileDir,gulp.series(configInit,"build",reload))}),gulp.task("watch:html",function(){return gulp.watch(watch.html,gulp.series("build:html",reload))}),gulp.task("watch:css",function(){return gulp.watch(watch.css,gulp.series("build:css",reload))}),gulp.task("watch:js",function(){return gulp.watch(watch.js,gulp.series("build:js",reload))}),gulp.task("watch:svg",function(){return gulp.watch(watch.svg,gulp.series("build:svg",reload))}),gulp.task("watch:img",function(){return gulp.watch(watch.img,gulp.series("build:img",reload))}),gulp.task("clean:html",function(t){$.del(dest.html),t()}),gulp.task("clean:css ",function(t){$.del(dest.css),t()}),gulp.task("clean:js  ",function(t){$.del(dest.js),t()}),gulp.task("clean:svg ",function(t){$.del(dest.svg),t()}),gulp.task("clean:img ",function(t){$.del(dest.img),t()}),gulp.task("build",gulp.series(gulp.parallel(data.mcbw.css[2]?"build:css":no,data.mcbw.js[2]?"build:js":no,data.mcbw.svg[2]?"build:svg":no,data.mcbw.img[2]?"build:img":no),data.mcbw.html[2]?"build:html":no)),gulp.task("watch",gulp.parallel(data.mcbw.html[3]?"watch:html":no,data.mcbw.css[3]?"watch:css":no,data.mcbw.js[3]?"watch:js":no,data.mcbw.svg[3]?"watch:svg":no,data.mcbw.img[3]?"watch:img":no,"watch:cfg ")),gulp.task("clean",function(t){var s=data.mcbw,a=[];for(var e in s)s.hasOwnProperty(e)&&(s[e][1]?a.push(dest[e]):0);$.del(a,plg.del),t()}),gulp.task("sync",function(t){$.browserSync.init(plg.browserSync),t()}),gulp.task("default",gulp.parallel(gulp.series("build","sync"),"watch"));
